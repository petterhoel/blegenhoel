---
import Layout from '../../layouts/Layout.astro'
import { dataClient } from '../../cms-integration/data-client'
import { PortableText } from 'astro-portabletext'
import ContactDetails from '../../ContactDetails.astro'
import { getSeoAsync } from '../../cms-integration/seo-client'
import { getLangFromUrl, useTranslation } from '../../i18n/utils'

export async function getAboutWorksText() {
  const query = `*[_type == "aboutWorks"][0]`
  const homepage = await dataClient.fetch(query)
  return homepage
}

const { aboutWorks } = await getAboutWorksText()
const { keywords, description } = await getSeoAsync()
const language = getLangFromUrl(Astro.url)
const t = useTranslation(language);
const title = t('title.about-works')
---

<Layout
  title={title}k
  keywords={keywords}
  description={description}>
  <article>
    <PortableText value={aboutWorks[language]} />
  </article>
  <aside>
    <ContactDetails />
  </aside>
</Layout>
